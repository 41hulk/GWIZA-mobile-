{"ast":null,"code":"'use strict';var _toConsumableArray=require(\"@babel/runtime/helpers/toConsumableArray\");Object.defineProperty(exports,\"__esModule\",{value:true});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};var _NavigationActions=require(\"../NavigationActions\");var _NavigationActions2=_interopRequireDefault(_NavigationActions);var _StackActions=require(\"./StackActions\");var _StackActions2=_interopRequireDefault(_StackActions);var _createConfigGetter=require(\"./createConfigGetter\");var _createConfigGetter2=_interopRequireDefault(_createConfigGetter);var _getScreenForRouteName=require(\"./getScreenForRouteName\");var _getScreenForRouteName2=_interopRequireDefault(_getScreenForRouteName);var _StateUtils=require(\"../StateUtils\");var _StateUtils2=_interopRequireDefault(_StateUtils);var _validateRouteConfigMap=require(\"./validateRouteConfigMap\");var _validateRouteConfigMap2=_interopRequireDefault(_validateRouteConfigMap);var _invariant=require(\"../utils/invariant\");var _invariant2=_interopRequireDefault(_invariant);var _KeyGenerator=require(\"./KeyGenerator\");var _pathUtils=require(\"./pathUtils\");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function behavesLikePushAction(action){return action.type===_NavigationActions2.default.NAVIGATE||action.type===_StackActions2.default.PUSH;}var defaultActionCreators=function defaultActionCreators(){return{};};function isResetToRootStack(action){return action.type===_StackActions2.default.RESET&&action.key===null;}exports.default=function(routeConfigs){var stackConfig=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};(0,_validateRouteConfigMap2.default)(routeConfigs);var childRouters={};var routeNames=Object.keys(routeConfigs);routeNames.forEach(function(routeName){var screen=(0,_getScreenForRouteName2.default)(routeConfigs,routeName);if(screen&&screen.router){childRouters[routeName]=screen.router;}else{childRouters[routeName]=null;}});var initialRouteParams=stackConfig.initialRouteParams;var getCustomActionCreators=stackConfig.getCustomActionCreators||defaultActionCreators;var initialRouteName=stackConfig.initialRouteName||routeNames[0];var initialChildRouter=childRouters[initialRouteName];function getInitialState(action){var route={};var childRouter=childRouters[action.routeName];if(behavesLikePushAction(action)&&childRouter!==undefined){var childState={};if(childRouter!==null){var childAction=action.action||_NavigationActions2.default.init({params:action.params});childState=childRouter.getStateForAction(childAction);}return{key:'StackRouterRoot',isTransitioning:false,index:0,routes:[_extends({params:action.params},childState,{key:action.key||(0,_KeyGenerator.generateKey)(),routeName:action.routeName})]};}if(initialChildRouter){route=initialChildRouter.getStateForAction(_NavigationActions2.default.navigate({routeName:initialRouteName,params:initialRouteParams}));}var params=(routeConfigs[initialRouteName].params||route.params||action.params||initialRouteParams)&&_extends({},routeConfigs[initialRouteName].params||{},route.params||{},action.params||{},initialRouteParams||{});var initialRouteKey=stackConfig.initialRouteKey;route=_extends({},route,params?{params:params}:{},{routeName:initialRouteName,key:action.key||initialRouteKey||(0,_KeyGenerator.generateKey)()});return{key:'StackRouterRoot',isTransitioning:false,index:0,routes:[route]};}function getParamsForRouteAndAction(routeName,action){var routeConfig=routeConfigs[routeName];if(routeConfig&&routeConfig.params){return _extends({},routeConfig.params,action.params);}else{return action.params;}}var _ref=(0,_pathUtils.createPathParser)(childRouters,routeConfigs,stackConfig),getPathAndParamsForRoute=_ref.getPathAndParamsForRoute,_getActionForPathAndParams=_ref.getActionForPathAndParams;return{childRouters:childRouters,getComponentForState:function getComponentForState(state){var activeChildRoute=state.routes[state.index];var routeName=activeChildRoute.routeName;if(childRouters[routeName]){return childRouters[routeName].getComponentForState(activeChildRoute);}return(0,_getScreenForRouteName2.default)(routeConfigs,routeName);},getComponentForRouteName:function getComponentForRouteName(routeName){return(0,_getScreenForRouteName2.default)(routeConfigs,routeName);},getActionCreators:function getActionCreators(route,navStateKey){return _extends({},getCustomActionCreators(route,navStateKey),{pop:function pop(n,params){return _StackActions2.default.pop(_extends({n:n},params));},popToTop:function popToTop(params){return _StackActions2.default.popToTop(params);},push:function push(routeName,params,action){return _StackActions2.default.push({routeName:routeName,params:params,action:action});},replace:function replace(replaceWith,params,action,newKey){if(typeof replaceWith==='string'){return _StackActions2.default.replace({routeName:replaceWith,params:params,action:action,key:route.key,newKey:newKey});}(0,_invariant2.default)(typeof replaceWith==='object','Must replaceWith an object or a string');(0,_invariant2.default)(params==null,'Params must not be provided to .replace() when specifying an object');(0,_invariant2.default)(action==null,'Child action must not be provided to .replace() when specifying an object');(0,_invariant2.default)(newKey==null,'Child action must not be provided to .replace() when specifying an object');return _StackActions2.default.replace(replaceWith);},reset:function reset(actions,index){return _StackActions2.default.reset({actions:actions,index:index==null?actions.length-1:index,key:navStateKey});},dismiss:function dismiss(){return _NavigationActions2.default.back({key:navStateKey});}});},getStateForAction:function getStateForAction(action,state){if(!state){return getInitialState(action);}var activeChildRoute=state.routes[state.index];if(!isResetToRootStack(action)&&action.type!==_NavigationActions2.default.NAVIGATE){var activeChildRouter=childRouters[activeChildRoute.routeName];if(activeChildRouter){var route=activeChildRouter.getStateForAction(action,activeChildRoute);if(route!==null&&route!==activeChildRoute){return _StateUtils2.default.replaceAt(state,activeChildRoute.key,route,action.type===_NavigationActions2.default.SET_PARAMS);}}}else if(action.type===_NavigationActions2.default.NAVIGATE){for(var _iterator=state.routes.slice().reverse(),_isArray=Array.isArray(_iterator),_i=0,_iterator=_isArray?_iterator:_iterator[typeof Symbol===\"function\"?Symbol.iterator:\"@@iterator\"]();;){var _ref2;if(_isArray){if(_i>=_iterator.length)break;_ref2=_iterator[_i++];}else{_i=_iterator.next();if(_i.done)break;_ref2=_i.value;}var childRoute=_ref2;var childRouter=childRouters[childRoute.routeName];var childAction=action.routeName===childRoute.routeName&&action.action?action.action:action;if(childRouter){var nextRouteState=childRouter.getStateForAction(childAction,childRoute);if(nextRouteState===null||nextRouteState!==childRoute){var newState=_StateUtils2.default.replaceAndPrune(state,nextRouteState?nextRouteState.key:childRoute.key,nextRouteState?nextRouteState:childRoute);return _extends({},newState,{isTransitioning:state.index!==newState.index?action.immediate!==true:state.isTransitioning});}}}}if(behavesLikePushAction(action)&&childRouters[action.routeName]!==undefined){var _childRouter=childRouters[action.routeName];var _route=void 0;(0,_invariant2.default)(action.type!==_StackActions2.default.PUSH||action.key==null,'StackRouter does not support key on the push action');var lastRouteIndex=state.routes.findIndex(function(r){if(action.key){return r.key===action.key;}else{return r.routeName===action.routeName;}});if(action.type!==_StackActions2.default.PUSH&&lastRouteIndex!==-1){if(state.index===lastRouteIndex&&!action.params){return null;}var routes=state.routes.slice(0,lastRouteIndex+1);if(action.params){var _route2=state.routes[lastRouteIndex];routes[lastRouteIndex]=_extends({},_route2,{params:_extends({},_route2.params,action.params)});}return _extends({},state,{isTransitioning:state.index!==lastRouteIndex?action.immediate!==true:state.isTransitioning,index:lastRouteIndex,routes:routes});}if(_childRouter){var _childAction=action.action||_NavigationActions2.default.init({params:getParamsForRouteAndAction(action.routeName,action)});_route=_extends({params:getParamsForRouteAndAction(action.routeName,action)},_childRouter.getStateForAction(_childAction),{routeName:action.routeName,key:action.key||(0,_KeyGenerator.generateKey)()});}else{_route={params:getParamsForRouteAndAction(action.routeName,action),routeName:action.routeName,key:action.key||(0,_KeyGenerator.generateKey)()};}return _extends({},_StateUtils2.default.push(state,_route),{isTransitioning:action.immediate!==true});}else if(action.type===_StackActions2.default.PUSH&&childRouters[action.routeName]===undefined){return state;}if(behavesLikePushAction(action)){var childRouterNames=Object.keys(childRouters);for(var i=0;i<childRouterNames.length;i++){var childRouterName=childRouterNames[i];var _childRouter2=childRouters[childRouterName];if(_childRouter2){var initChildRoute=_childRouter2.getStateForAction(_NavigationActions2.default.init());var navigatedChildRoute=_childRouter2.getStateForAction(action,initChildRoute);var routeToPush=null;if(navigatedChildRoute===null){routeToPush=initChildRoute;}else if(navigatedChildRoute!==initChildRoute){routeToPush=navigatedChildRoute;}if(routeToPush){var _route3=_extends({},routeToPush,{routeName:childRouterName,key:action.key||(0,_KeyGenerator.generateKey)()});return _extends({},_StateUtils2.default.push(state,_route3),{isTransitioning:action.immediate!==true});}}}}if(action.type===_StackActions2.default.POP_TO_TOP){if(action.key&&state.key!==action.key){return state;}if(state.index>0){return _extends({},state,{isTransitioning:action.immediate!==true,index:0,routes:[state.routes[0]]});}return state;}if(action.type===_StackActions2.default.REPLACE){var routeIndex=void 0;if(action.key===undefined&&state.routes.length){routeIndex=state.routes.length-1;}else{routeIndex=state.routes.findIndex(function(r){return r.key===action.key;});}if(routeIndex!==-1){var _childRouter3=childRouters[action.routeName];var childState={};if(_childRouter3){var _childAction2=action.action||_NavigationActions2.default.init({params:getParamsForRouteAndAction(action.routeName,action)});childState=_childRouter3.getStateForAction(_childAction2);}var _routes=_toConsumableArray(state.routes);_routes[routeIndex]=_extends({params:getParamsForRouteAndAction(action.routeName,action)},childState,{routeName:action.routeName,key:action.newKey||(0,_KeyGenerator.generateKey)()});return _extends({},state,{routes:_routes});}}if(action.type===_StackActions2.default.COMPLETE_TRANSITION&&(action.key==null||action.key===state.key)&&action.toChildKey===state.routes[state.index].key&&state.isTransitioning){return _extends({},state,{isTransitioning:false});}if(action.type===_NavigationActions2.default.SET_PARAMS){var key=action.key;var lastRoute=state.routes.find(function(route){return route.key===key;});if(lastRoute){var params=_extends({},lastRoute.params,action.params);var _routes2=_toConsumableArray(state.routes);_routes2[state.routes.indexOf(lastRoute)]=_extends({},lastRoute,{params:params});return _extends({},state,{routes:_routes2});}}if(action.type===_StackActions2.default.RESET){if(action.key!=null&&action.key!=state.key){return state;}var newStackActions=action.actions;return _extends({},state,{routes:newStackActions.map(function(newStackAction){var router=childRouters[newStackAction.routeName];var childState={};if(router){var _childAction3=newStackAction.action||_NavigationActions2.default.init({params:getParamsForRouteAndAction(newStackAction.routeName,newStackAction)});childState=router.getStateForAction(_childAction3);}return _extends({params:getParamsForRouteAndAction(newStackAction.routeName,newStackAction)},childState,{routeName:newStackAction.routeName,key:newStackAction.key||(0,_KeyGenerator.generateKey)()});}),index:action.index});}if(action.type===_NavigationActions2.default.BACK||action.type===_StackActions2.default.POP){var _key=action.key,n=action.n,immediate=action.immediate;var backRouteIndex=state.index;if(action.type===_StackActions2.default.POP&&n!=null){backRouteIndex=Math.max(1,state.index-n+1);}else if(_key){var backRoute=state.routes.find(function(route){return route.key===_key;});backRouteIndex=state.routes.indexOf(backRoute);}if(backRouteIndex>0){return _extends({},state,{routes:state.routes.slice(0,backRouteIndex),index:backRouteIndex-1,isTransitioning:immediate!==true});}}var keyIndex=action.key?_StateUtils2.default.indexOf(state,action.key):-1;for(var _iterator2=state.routes.slice().reverse(),_isArray2=Array.isArray(_iterator2),_i2=0,_iterator2=_isArray2?_iterator2:_iterator2[typeof Symbol===\"function\"?Symbol.iterator:\"@@iterator\"]();;){var _ref3;if(_isArray2){if(_i2>=_iterator2.length)break;_ref3=_iterator2[_i2++];}else{_i2=_iterator2.next();if(_i2.done)break;_ref3=_i2.value;}var _childRoute=_ref3;if(_childRoute.key===activeChildRoute.key){continue;}if(keyIndex>=0&&_childRoute.key!==action.key){continue;}var _childRouter4=childRouters[_childRoute.routeName];if(_childRouter4){var _route4=_childRouter4.getStateForAction(action,_childRoute);if(_route4===null){return state;}else if(_route4&&_route4!==_childRoute){return _StateUtils2.default.replaceAt(state,_childRoute.key,_route4,action.type===_NavigationActions2.default.SET_PARAMS||action.type===_StackActions2.default.COMPLETE_TRANSITION||action.type.includes('DRAWER'));}}}return state;},getPathAndParamsForState:function getPathAndParamsForState(state){var route=state.routes[state.index];return getPathAndParamsForRoute(route);},getActionForPathAndParams:function getActionForPathAndParams(path,params){return _getActionForPathAndParams(path,params);},getScreenOptions:(0,_createConfigGetter2.default)(routeConfigs,stackConfig.defaultNavigationOptions)};};","map":{"version":3,"sources":["/Users/ntareguy/Downloads/gwizamobile1/node_modules/@react-navigation/core/dist/routers/StackRouter.js"],"names":["Object","defineProperty","exports","value","_extends","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_NavigationActions","require","_NavigationActions2","_interopRequireDefault","_StackActions","_StackActions2","_createConfigGetter","_createConfigGetter2","_getScreenForRouteName","_getScreenForRouteName2","_StateUtils","_StateUtils2","_validateRouteConfigMap","_validateRouteConfigMap2","_invariant","_invariant2","_KeyGenerator","_pathUtils","obj","__esModule","default","behavesLikePushAction","action","type","NAVIGATE","PUSH","defaultActionCreators","isResetToRootStack","RESET","routeConfigs","stackConfig","childRouters","routeNames","keys","forEach","routeName","screen","router","initialRouteParams","getCustomActionCreators","initialRouteName","initialChildRouter","getInitialState","route","childRouter","undefined","childState","childAction","init","params","getStateForAction","isTransitioning","index","routes","generateKey","navigate","initialRouteKey","getParamsForRouteAndAction","routeConfig","createPathParser","getPathAndParamsForRoute","getActionForPathAndParams","getComponentForState","state","activeChildRoute","getComponentForRouteName","getActionCreators","navStateKey","pop","n","popToTop","push","replace","replaceWith","newKey","reset","actions","dismiss","back","activeChildRouter","replaceAt","SET_PARAMS","slice","reverse","childRoute","nextRouteState","newState","replaceAndPrune","immediate","_childRouter","_route","lastRouteIndex","findIndex","r","_route2","_childAction","childRouterNames","childRouterName","_childRouter2","initChildRoute","navigatedChildRoute","routeToPush","_route3","POP_TO_TOP","REPLACE","routeIndex","_childRouter3","_childAction2","_routes","COMPLETE_TRANSITION","toChildKey","lastRoute","find","_routes2","indexOf","newStackActions","map","newStackAction","_childAction3","BACK","POP","_key","backRouteIndex","Math","max","backRoute","keyIndex","_childRoute","_childRouter4","_route4","includes","getPathAndParamsForState","path","getScreenOptions","defaultNavigationOptions"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _NavigationActions = require('../NavigationActions');\n\nvar _NavigationActions2 = _interopRequireDefault(_NavigationActions);\n\nvar _StackActions = require('./StackActions');\n\nvar _StackActions2 = _interopRequireDefault(_StackActions);\n\nvar _createConfigGetter = require('./createConfigGetter');\n\nvar _createConfigGetter2 = _interopRequireDefault(_createConfigGetter);\n\nvar _getScreenForRouteName = require('./getScreenForRouteName');\n\nvar _getScreenForRouteName2 = _interopRequireDefault(_getScreenForRouteName);\n\nvar _StateUtils = require('../StateUtils');\n\nvar _StateUtils2 = _interopRequireDefault(_StateUtils);\n\nvar _validateRouteConfigMap = require('./validateRouteConfigMap');\n\nvar _validateRouteConfigMap2 = _interopRequireDefault(_validateRouteConfigMap);\n\nvar _invariant = require('../utils/invariant');\n\nvar _invariant2 = _interopRequireDefault(_invariant);\n\nvar _KeyGenerator = require('./KeyGenerator');\n\nvar _pathUtils = require('./pathUtils');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction behavesLikePushAction(action) {\n  return action.type === _NavigationActions2.default.NAVIGATE || action.type === _StackActions2.default.PUSH;\n}\n\nvar defaultActionCreators = () => ({});\n\nfunction isResetToRootStack(action) {\n  return action.type === _StackActions2.default.RESET && action.key === null;\n}\n\nexports.default = (routeConfigs, stackConfig = {}) => {\n  // Fail fast on invalid route definitions\n  (0, _validateRouteConfigMap2.default)(routeConfigs);\n\n  var childRouters = {};\n  var routeNames = Object.keys(routeConfigs);\n\n  // Loop through routes and find child routers\n  routeNames.forEach(routeName => {\n    var screen = (0, _getScreenForRouteName2.default)(routeConfigs, routeName);\n    if (screen && screen.router) {\n      // If it has a router it's a navigator.\n      childRouters[routeName] = screen.router;\n    } else {\n      // If it doesn't have router it's an ordinary React component.\n      childRouters[routeName] = null;\n    }\n  });\n\n  var { initialRouteParams } = stackConfig;\n  var getCustomActionCreators = stackConfig.getCustomActionCreators || defaultActionCreators;\n\n  var initialRouteName = stackConfig.initialRouteName || routeNames[0];\n\n  var initialChildRouter = childRouters[initialRouteName];\n\n  function getInitialState(action) {\n    var route = {};\n    var childRouter = childRouters[action.routeName];\n\n    // This is a push-like action, and childRouter will be a router or null if we are responsible for this routeName\n    if (behavesLikePushAction(action) && childRouter !== undefined) {\n      var childState = {};\n      // The router is null for normal leaf routes\n      if (childRouter !== null) {\n        var childAction = action.action || _NavigationActions2.default.init({ params: action.params });\n        childState = childRouter.getStateForAction(childAction);\n      }\n\n      return {\n        key: 'StackRouterRoot',\n        isTransitioning: false,\n        index: 0,\n        routes: [_extends({\n          params: action.params\n        }, childState, {\n          key: action.key || (0, _KeyGenerator.generateKey)(),\n          routeName: action.routeName\n        })]\n      };\n    }\n\n    if (initialChildRouter) {\n      route = initialChildRouter.getStateForAction(_NavigationActions2.default.navigate({\n        routeName: initialRouteName,\n        params: initialRouteParams\n      }));\n    }\n    var params = (routeConfigs[initialRouteName].params || route.params || action.params || initialRouteParams) && _extends({}, routeConfigs[initialRouteName].params || {}, route.params || {}, action.params || {}, initialRouteParams || {});\n    var { initialRouteKey } = stackConfig;\n    route = _extends({}, route, params ? { params } : {}, {\n      routeName: initialRouteName,\n      key: action.key || initialRouteKey || (0, _KeyGenerator.generateKey)()\n    });\n    return {\n      key: 'StackRouterRoot',\n      isTransitioning: false,\n      index: 0,\n      routes: [route]\n    };\n  }\n\n  function getParamsForRouteAndAction(routeName, action) {\n    var routeConfig = routeConfigs[routeName];\n    if (routeConfig && routeConfig.params) {\n      return _extends({}, routeConfig.params, action.params);\n    } else {\n      return action.params;\n    }\n  }\n\n  var {\n    getPathAndParamsForRoute,\n    getActionForPathAndParams\n  } = (0, _pathUtils.createPathParser)(childRouters, routeConfigs, stackConfig);\n\n  return {\n    childRouters,\n\n    getComponentForState(state) {\n      var activeChildRoute = state.routes[state.index];\n      var { routeName } = activeChildRoute;\n      if (childRouters[routeName]) {\n        return childRouters[routeName].getComponentForState(activeChildRoute);\n      }\n      return (0, _getScreenForRouteName2.default)(routeConfigs, routeName);\n    },\n\n    getComponentForRouteName(routeName) {\n      return (0, _getScreenForRouteName2.default)(routeConfigs, routeName);\n    },\n\n    getActionCreators(route, navStateKey) {\n      return _extends({}, getCustomActionCreators(route, navStateKey), {\n        pop: (n, params) => _StackActions2.default.pop(_extends({\n          n\n        }, params)),\n        popToTop: params => _StackActions2.default.popToTop(params),\n        push: (routeName, params, action) => _StackActions2.default.push({\n          routeName,\n          params,\n          action\n        }),\n        replace: (replaceWith, params, action, newKey) => {\n          if (typeof replaceWith === 'string') {\n            return _StackActions2.default.replace({\n              routeName: replaceWith,\n              params,\n              action,\n              key: route.key,\n              newKey\n            });\n          }\n          (0, _invariant2.default)(typeof replaceWith === 'object', 'Must replaceWith an object or a string');\n          (0, _invariant2.default)(params == null, 'Params must not be provided to .replace() when specifying an object');\n          (0, _invariant2.default)(action == null, 'Child action must not be provided to .replace() when specifying an object');\n          (0, _invariant2.default)(newKey == null, 'Child action must not be provided to .replace() when specifying an object');\n          return _StackActions2.default.replace(replaceWith);\n        },\n        reset: (actions, index) => _StackActions2.default.reset({\n          actions,\n          index: index == null ? actions.length - 1 : index,\n          key: navStateKey\n        }),\n        dismiss: () => _NavigationActions2.default.back({\n          key: navStateKey\n        })\n      });\n    },\n\n    getStateForAction(action, state) {\n      // Set up the initial state if needed\n      if (!state) {\n        return getInitialState(action);\n      }\n\n      var activeChildRoute = state.routes[state.index];\n\n      if (!isResetToRootStack(action) && action.type !== _NavigationActions2.default.NAVIGATE) {\n        // Let the active child router handle the action\n        var activeChildRouter = childRouters[activeChildRoute.routeName];\n        if (activeChildRouter) {\n          var route = activeChildRouter.getStateForAction(action, activeChildRoute);\n          if (route !== null && route !== activeChildRoute) {\n            return _StateUtils2.default.replaceAt(state, activeChildRoute.key, route,\n            // the following tells replaceAt to NOT change the index to this route for the setParam action, because people don't expect param-setting actions to switch the active route\n            action.type === _NavigationActions2.default.SET_PARAMS);\n          }\n        }\n      } else if (action.type === _NavigationActions2.default.NAVIGATE) {\n        // Traverse routes from the top of the stack to the bottom, so the\n        // active route has the first opportunity, then the one before it, etc.\n\n        for (var childRoute of state.routes.slice().reverse()) {\n          var childRouter = childRouters[childRoute.routeName];\n          var childAction = action.routeName === childRoute.routeName && action.action ? action.action : action;\n\n          if (childRouter) {\n            var nextRouteState = childRouter.getStateForAction(childAction, childRoute);\n\n            if (nextRouteState === null || nextRouteState !== childRoute) {\n              var newState = _StateUtils2.default.replaceAndPrune(state, nextRouteState ? nextRouteState.key : childRoute.key, nextRouteState ? nextRouteState : childRoute);\n              return _extends({}, newState, {\n                isTransitioning: state.index !== newState.index ? action.immediate !== true : state.isTransitioning\n              });\n            }\n          }\n        }\n      }\n\n      // Handle push and navigate actions. This must happen after the focused\n      // child router has had a chance to handle the action.\n      if (behavesLikePushAction(action) && childRouters[action.routeName] !== undefined // undefined means it's not a childRouter or a screen\n      ) {\n          var _childRouter = childRouters[action.routeName];\n          var _route = void 0;\n\n          (0, _invariant2.default)(action.type !== _StackActions2.default.PUSH || action.key == null, 'StackRouter does not support key on the push action');\n\n          // Before pushing a new route we first try to find one in the existing route stack\n          // More information on this: https://github.com/react-navigation/rfcs/blob/master/text/0004-less-pushy-navigate.md\n          var lastRouteIndex = state.routes.findIndex(r => {\n            if (action.key) {\n              return r.key === action.key;\n            } else {\n              return r.routeName === action.routeName;\n            }\n          });\n\n          // An instance of this route exists already and we're dealing with a navigate action\n          if (action.type !== _StackActions2.default.PUSH && lastRouteIndex !== -1) {\n            // If index is unchanged and params are not being set, leave state identity intact\n            if (state.index === lastRouteIndex && !action.params) {\n              return null;\n            }\n\n            // Remove the now unused routes at the tail of the routes array\n            var routes = state.routes.slice(0, lastRouteIndex + 1);\n\n            // Apply params if provided, otherwise leave route identity intact\n            if (action.params) {\n              var _route2 = state.routes[lastRouteIndex];\n              routes[lastRouteIndex] = _extends({}, _route2, {\n                params: _extends({}, _route2.params, action.params)\n              });\n            }\n            // Return state with new index. Change isTransitioning only if index has changed\n            return _extends({}, state, {\n              isTransitioning: state.index !== lastRouteIndex ? action.immediate !== true : state.isTransitioning,\n              index: lastRouteIndex,\n              routes\n            });\n          }\n\n          if (_childRouter) {\n            // Delegate to the child router with the given action, or init it\n            var _childAction = action.action || _NavigationActions2.default.init({\n              params: getParamsForRouteAndAction(action.routeName, action)\n            });\n            _route = _extends({\n              params: getParamsForRouteAndAction(action.routeName, action)\n            }, _childRouter.getStateForAction(_childAction), {\n              routeName: action.routeName,\n              key: action.key || (0, _KeyGenerator.generateKey)()\n            });\n          } else {\n            // Create the route from scratch\n            _route = {\n              params: getParamsForRouteAndAction(action.routeName, action),\n              routeName: action.routeName,\n              key: action.key || (0, _KeyGenerator.generateKey)()\n            };\n          }\n          return _extends({}, _StateUtils2.default.push(state, _route), {\n            isTransitioning: action.immediate !== true\n          });\n        } else if (action.type === _StackActions2.default.PUSH && childRouters[action.routeName] === undefined) {\n        // Return the state identity to bubble the action up\n        return state;\n      }\n\n      // Handle navigation to other child routers that are not yet pushed\n      if (behavesLikePushAction(action)) {\n        var childRouterNames = Object.keys(childRouters);\n        for (var i = 0; i < childRouterNames.length; i++) {\n          var childRouterName = childRouterNames[i];\n          var _childRouter2 = childRouters[childRouterName];\n          if (_childRouter2) {\n            // For each child router, start with a blank state\n            var initChildRoute = _childRouter2.getStateForAction(_NavigationActions2.default.init());\n            // Then check to see if the router handles our navigate action\n            var navigatedChildRoute = _childRouter2.getStateForAction(action, initChildRoute);\n            var routeToPush = null;\n            if (navigatedChildRoute === null) {\n              // Push the route if the router has 'handled' the action and returned null\n              routeToPush = initChildRoute;\n            } else if (navigatedChildRoute !== initChildRoute) {\n              // Push the route if the state has changed in response to this navigation\n              routeToPush = navigatedChildRoute;\n            }\n            if (routeToPush) {\n              var _route3 = _extends({}, routeToPush, {\n                routeName: childRouterName,\n                key: action.key || (0, _KeyGenerator.generateKey)()\n              });\n              return _extends({}, _StateUtils2.default.push(state, _route3), {\n                isTransitioning: action.immediate !== true\n              });\n            }\n          }\n        }\n      }\n\n      // Handle pop-to-top behavior. Make sure this happens after children have had a chance to handle the action, so that the inner stack pops to top first.\n      if (action.type === _StackActions2.default.POP_TO_TOP) {\n        // Refuse to handle pop to top if a key is given that doesn't correspond\n        // to this router\n        if (action.key && state.key !== action.key) {\n          return state;\n        }\n\n        // If we're already at the top, then we return the state with a new\n        // identity so that the action is handled by this router.\n        if (state.index > 0) {\n          return _extends({}, state, {\n            isTransitioning: action.immediate !== true,\n            index: 0,\n            routes: [state.routes[0]]\n          });\n        }\n        return state;\n      }\n\n      // Handle replace action\n      if (action.type === _StackActions2.default.REPLACE) {\n        var routeIndex = void 0;\n\n        // If the key param is undefined, set the index to the last route in the stack\n        if (action.key === undefined && state.routes.length) {\n          routeIndex = state.routes.length - 1;\n        } else {\n          routeIndex = state.routes.findIndex(r => r.key === action.key);\n        }\n\n        // Only replace if the key matches one of our routes\n        if (routeIndex !== -1) {\n          var _childRouter3 = childRouters[action.routeName];\n          var childState = {};\n          if (_childRouter3) {\n            var _childAction2 = action.action || _NavigationActions2.default.init({\n              params: getParamsForRouteAndAction(action.routeName, action)\n            });\n            childState = _childRouter3.getStateForAction(_childAction2);\n          }\n          var _routes = [...state.routes];\n          _routes[routeIndex] = _extends({\n            params: getParamsForRouteAndAction(action.routeName, action)\n          }, childState, {\n            routeName: action.routeName,\n            key: action.newKey || (0, _KeyGenerator.generateKey)()\n          });\n          return _extends({}, state, { routes: _routes });\n        }\n      }\n\n      // Update transitioning state\n      if (action.type === _StackActions2.default.COMPLETE_TRANSITION && (action.key == null || action.key === state.key) && action.toChildKey === state.routes[state.index].key && state.isTransitioning) {\n        return _extends({}, state, {\n          isTransitioning: false\n        });\n      }\n\n      if (action.type === _NavigationActions2.default.SET_PARAMS) {\n        var key = action.key;\n        var lastRoute = state.routes.find(route => route.key === key);\n        if (lastRoute) {\n          var params = _extends({}, lastRoute.params, action.params);\n          var _routes2 = [...state.routes];\n          _routes2[state.routes.indexOf(lastRoute)] = _extends({}, lastRoute, {\n            params\n          });\n          return _extends({}, state, {\n            routes: _routes2\n          });\n        }\n      }\n\n      if (action.type === _StackActions2.default.RESET) {\n        // Only handle reset actions that are unspecified or match this state key\n        if (action.key != null && action.key != state.key) {\n          // Deliberately use != instead of !== so we can match null with\n          // undefined on either the state or the action\n          return state;\n        }\n        var newStackActions = action.actions;\n\n        return _extends({}, state, {\n          routes: newStackActions.map(newStackAction => {\n            var router = childRouters[newStackAction.routeName];\n\n            var childState = {};\n\n            if (router) {\n              var _childAction3 = newStackAction.action || _NavigationActions2.default.init({\n                params: getParamsForRouteAndAction(newStackAction.routeName, newStackAction)\n              });\n\n              childState = router.getStateForAction(_childAction3);\n            }\n\n            return _extends({\n              params: getParamsForRouteAndAction(newStackAction.routeName, newStackAction)\n            }, childState, {\n              routeName: newStackAction.routeName,\n              key: newStackAction.key || (0, _KeyGenerator.generateKey)()\n            });\n          }),\n          index: action.index\n        });\n      }\n\n      if (action.type === _NavigationActions2.default.BACK || action.type === _StackActions2.default.POP) {\n        var { key: _key, n, immediate } = action;\n        var backRouteIndex = state.index;\n        if (action.type === _StackActions2.default.POP && n != null) {\n          // determine the index to go back *from*. In this case, n=1 means to go\n          // back from state.index, as if it were a normal \"BACK\" action\n          backRouteIndex = Math.max(1, state.index - n + 1);\n        } else if (_key) {\n          var backRoute = state.routes.find(route => route.key === _key);\n          backRouteIndex = state.routes.indexOf(backRoute);\n        }\n\n        if (backRouteIndex > 0) {\n          return _extends({}, state, {\n            routes: state.routes.slice(0, backRouteIndex),\n            index: backRouteIndex - 1,\n            isTransitioning: immediate !== true\n          });\n        }\n      }\n\n      // By this point in the router's state handling logic, we have handled the behavior of the active route, and handled any stack actions.\n      // If we haven't returned by now, we should allow non-active child routers to handle this action, and switch to that index if the child state (route) does change..\n\n      var keyIndex = action.key ? _StateUtils2.default.indexOf(state, action.key) : -1;\n\n      // Traverse routes from the top of the stack to the bottom, so the\n      // active route has the first opportunity, then the one before it, etc.\n      for (var _childRoute of state.routes.slice().reverse()) {\n        if (_childRoute.key === activeChildRoute.key) {\n          // skip over the active child because we let it attempt to handle the action earlier\n          continue;\n        }\n        // If a key is provided and in routes state then let's use that\n        // knowledge to skip extra getStateForAction calls on other child\n        // routers\n        if (keyIndex >= 0 && _childRoute.key !== action.key) {\n          continue;\n        }\n        var _childRouter4 = childRouters[_childRoute.routeName];\n        if (_childRouter4) {\n          var _route4 = _childRouter4.getStateForAction(action, _childRoute);\n\n          if (_route4 === null) {\n            return state;\n          } else if (_route4 && _route4 !== _childRoute) {\n            return _StateUtils2.default.replaceAt(state, _childRoute.key, _route4,\n            // the following tells replaceAt to NOT change the index to this route for the setParam action or complete transition action,\n            // because people don't expect these actions to switch the active route\n            action.type === _NavigationActions2.default.SET_PARAMS || action.type === _StackActions2.default.COMPLETE_TRANSITION || action.type.includes('DRAWER'));\n          }\n        }\n      }\n\n      return state;\n    },\n\n    getPathAndParamsForState(state) {\n      var route = state.routes[state.index];\n      return getPathAndParamsForRoute(route);\n    },\n\n    getActionForPathAndParams(path, params) {\n      return getActionForPathAndParams(path, params);\n    },\n\n    getScreenOptions: (0, _createConfigGetter2.default)(routeConfigs, stackConfig.defaultNavigationOptions)\n  };\n};"]},"metadata":{},"sourceType":"script"}